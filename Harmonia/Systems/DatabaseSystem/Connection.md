# Connection

Represents a connection to a MySQL server.

## Methods

### __construct

Opens a connection to a MySQL server.

#### Syntax

```php
public function __construct(string $host, string $username, string $password, ?string $charset = null)
```

#### Parameters

- **$host**: The host name or IP address of the MySQL server.
- **$username**: The username for the MySQL authentication.
- **$password**: The password for the MySQL authentication.
- **$charset**: (Optional) The character set to use for the connection.

#### Exceptions

- **\RuntimeException**: If the connection to the MySQL server fails or if the character set cannot be set.

---

### __destruct

Closes the connection to the MySQL server.

#### Syntax

```php
public function __destruct()
```

---

### SelectDatabase

Selects a database as the current database for the subsequent queries.

#### Syntax

```php
public function SelectDatabase(string $databaseName): void
```

#### Parameters

- **$databaseName**: The name of the database to select.

#### Exceptions

- **\RuntimeException**: If the database selection fails.

---

### Execute

Executes a query on the MySQL server.

#### Syntax

```php
public function Execute(\Harmonia\Systems\DatabaseSystem\Queries\Query $query): ?\Harmonia\Systems\DatabaseSystem\Proxies\MySQLiResult
```

#### Parameters

- **$query**: The query object containing SQL and optionally its bindings.

#### Return Value

A `MySQLiResult` if the query produces a result set (such as `SELECT`, `SHOW`, `DESCRIBE`, `EXPLAIN`), or `null` if the query does not produce a result set (such as `INSERT`, `UPDATE`, `DELETE`, `REPLACE`).

#### Exceptions

- **\RuntimeException**: If the query preparation or execution fails.

---

### LastInsertId

Retrieves the ID generated by the last `INSERT` query.

#### Syntax

```php
public function LastInsertId(): int
```

#### Return Value

The auto-generated ID from the last successful `INSERT` query. Returns `0` if the last query was not an `INSERT` or no `AUTO_INCREMENT` value was generated.

---

### LastAffectedRowCount

Retrieves the number of rows affected by the last `INSERT`, `UPDATE`,
`REPLACE`, or `DELETE` query.

#### Syntax

```php
public function LastAffectedRowCount(): int
```

#### Return Value

The number of rows affected by the last modifying query. Returns `0` if no rows were affected. Returns `-1` if the query fails.

---

### BeginTransaction

Initiates a transaction.

#### Syntax

```php
public function BeginTransaction(): void
```

#### Exceptions

- **\RuntimeException**: If the transaction initiation fails.

---

### CommitTransaction

Commits the current transaction.

#### Syntax

```php
public function CommitTransaction(): void
```

#### Exceptions

- **\RuntimeException**: If the transaction commit fails.

---

### RollbackTransaction

Rolls back the current transaction.

#### Syntax

```php
public function RollbackTransaction(): void
```

#### Exceptions

- **\RuntimeException**: If the transaction rollback fails.

---

### EscapeString

Escapes special characters in a string for use in SQL statements.

This method is intended for use in SQL queries where parameter binding
is not supported by the database engine (e.g., `SHOW DATABASES LIKE`).
It helps prevent SQL injection by escaping input values.

The returned value is not quoted automatically. It is the caller's
responsibility to wrap the result in single quotes when embedding it
directly in a SQL string.

#### Example
```php
$sql = "SHOW DATABASES LIKE '{$connection->EscapeString($name)}'";
```

#### Syntax

```php
public function EscapeString(string $string): string
```

#### Parameters

- **$string**: The string to be escaped.

#### Return Value

The escaped string, safe for use in SQL contexts when properly quoted.

---

*This documentation was automatically generated using [phpDocumentor](http://www.phpdoc.org/) with the [Calliope](https://github.com/DaphneWebFramework/Calliope) template.*
