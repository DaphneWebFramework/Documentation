# Connection

Represents a connection to a MySQL server.

## Methods

### __construct

Opens a connection to a MySQL server.

#### Syntax

```php
public function __construct(string $host, string $username, string $password, ?string $charset = null)
```

#### Parameters

- **$host**: The host name or IP address of the MySQL server.
- **$username**: The username for the MySQL authentication.
- **$password**: The password for the MySQL authentication.
- **$charset**: (Optional) The character set to use for the connection.

#### Exceptions

- **\RuntimeException**: If the connection to the MySQL server fails or if the character set cannot be set.

---

### __destruct

Closes the connection to the MySQL server.

#### Syntax

```php
public function __destruct()
```

---

### SelectDatabase

Selects a database as the current database for the subsequent queries.

#### Syntax

```php
public function SelectDatabase(string $databaseName): void
```

#### Parameters

- **$databaseName**: The name of the database to select.

#### Exceptions

- **\RuntimeException**: If the database selection fails.

---

### Execute

Executes a query on the MySQL server.

This method prepares and executes the given query. If the query produces
a result set (such as `SELECT`, `SHOW`, `DESCRIBE`, or `EXPLAIN`), it
returns a `MySQLiResult` object. For queries that do not produce a result
set (such as `INSERT`, `UPDATE`, or `DELETE`), it returns `null`. Any
execution failure results in an exception.

#### Syntax

```php
public function Execute(\Harmonia\Systems\DatabaseSystem\Queries\Query $query): ?\Harmonia\Systems\DatabaseSystem\Proxies\MySQLiResult
```

#### Parameters

- **$query**: The query object containing SQL and optionally its bindings.

#### Return Value

A `MySQLiResult` if the query produces a result set, or `null` if the query does not produce a result set.

#### Exceptions

- **\RuntimeException**: If the query preparation or execution fails.

---

### LastInsertId

Retrieves the ID generated by the last `INSERT` query.

#### Syntax

```php
public function LastInsertId(): int
```

#### Return Value

The auto-generated ID from the last successful `INSERT` query. If the last query was not an `INSERT` or no `AUTO_INCREMENT` value was generated, this method returns `0`.

---

### LastAffectedRowCount

Retrieves the number of rows affected by the last `INSERT`, `UPDATE`,
`REPLACE`, or `DELETE` query.

#### Syntax

```php
public function LastAffectedRowCount(): int
```

#### Return Value

The number of rows affected by the last modifying query. Returns `0` if no rows were affected. Returns `-1` if the query failed.

---

### BeginTransaction

Initiates a transaction.

#### Syntax

```php
public function BeginTransaction(): void
```

#### Exceptions

- **\RuntimeException**: If the transaction initiation fails.

---

### CommitTransaction

Commits the current transaction.

#### Syntax

```php
public function CommitTransaction(): void
```

#### Exceptions

- **\RuntimeException**: If the transaction commit fails.

---

### RollbackTransaction

Rolls back the current transaction.

#### Syntax

```php
public function RollbackTransaction(): void
```

#### Exceptions

- **\RuntimeException**: If the transaction rollback fails.

---

*This documentation was automatically generated using [phpDocumentor](http://www.phpdoc.org/) with the [Calliope](https://github.com/DaphneWebFramework/Calliope) template.*
